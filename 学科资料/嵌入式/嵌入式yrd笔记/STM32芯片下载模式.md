### **一、JTAG下载模式**
#### **1. 基本原理**
- **接口标准**：基于IEEE 1149.1标准，通过5针接口（TCK、TMS、TDI、TDO、NRST）实现程序下载与调试。
- **功能**：支持程序烧录、在线调试（如单步执行、寄存器查看、断点设置）、芯片状态监控及边界扫描测试。
- **PPT关联内容**：  
  - 3.2.5节提到“5针的JTAG端口需要牺牲通用I/O口”，即JTAG会占用STM32的部分GPIO引脚（如PA13/PA14/PA15等）。

#### **2. 特点**
- **优点**：  
  - 功能全面，适合开发阶段的复杂调试。  
  - 支持芯片级初始化和故障诊断。  
- **缺点**：  
  - 占用引脚较多（5针），可能影响其他外设功能。  
  - 硬件成本较高，需专用JTAG调试器（如ST-Link、J-Link）。

#### **3. 典型应用场景**
- 开发初期的程序调试与验证。  
- 需要深度调试（如多核同步、寄存器级调试）的场景。


### **二、SWD下载模式**
#### **1. 基本原理**
- **接口标准**：串行线调试（Serial Wire Debug，SWD），仅需2针接口（SWCLK时钟线、SWDIO数据线，可选GND和VCC）。  
- **功能**：与JTAG类似，支持程序下载、调试，但省略了边界扫描等复杂功能。  
- **PPT关联内容**：  
  - 3.2.5节明确“2针的SWD串口”可替代JTAG，节省GPIO资源。

#### **2. 特点**
- **优点**：  
  - 仅需2个引脚，大幅节省I/O资源（如STM32F103RB的PA13/SWDIO、PA14/SWCLK）。  
  - 硬件成本低，通用调试器（如ST-Link）均支持。  
  - 传输速度与JTAG相当，适合大多数调试场景。  
- **缺点**：  
  - 不支持边界扫描测试，部分高级调试功能受限。

#### **3. 典型应用场景**
- 引脚资源紧张的嵌入式系统开发。  
- 量产阶段的快速程序烧录（配合调试器）。


### **三、Bootloader串口下载模式**
#### **1. 基本原理**
- **核心机制**：利用STM32内部出厂预装的 **Bootloader**（位于系统存储区，4KB Flash，PPT 3.1.1节），通过串口（USART1）将程序代码先下载到RAM，再写入内部Flash。  
- **操作步骤**：  
  1. **启动模式配置**：通过硬件引脚 **BOOT0=1**、**BOOT1=0**（PPT 3.2.6节启动配置电路），选择从系统存储区启动。  
  2. **串口通信**：使用USB转TTL模块连接STM32的USART1（TX/RX），通过软件（如ST-Link Utility、FlyMCU）发送hex/bin文件。  
  3. **代码写入**：Bootloader接收数据并执行“RAM缓存→Flash写入”操作，完成后需重启芯片并恢复启动模式（BOOT0=0）。

#### **2. 特点**
- **优点**：  
  - **无需调试器**：仅需串口工具，成本极低，适合量产。  
  - **兼容性强**：支持多种串口协议（如UART），可通过软件灵活控制。  
- **缺点**：  
  - 无法在线调试，仅能用于程序烧录。  
  - 需手动切换启动模式，开发阶段效率较低。

#### **3. 典型应用场景**
- 批量生产时的程序烧录（避免调试器成本）。  
- 无调试器环境下的程序更新（如远程固件升级，需配合用户自定义Bootloader）。


### **四、三种模式对比**
| **模式**         | **接口类型**  | **引脚数**  | **调试功能** | **启动依赖**   | **适用场景**    |
| -------------- | --------- | -------- | -------- | ---------- | ----------- |
| **JTAG**       | 5针标准接口    | 5（含GND）  | 支持全速调试   | 无需特殊启动配置   | 开发调试、复杂系统验证 |
| **SWD**        | 2针串行接口    | 2-4      | 支持基础调试   | 无需特殊启动配置   | 资源受限场景、快速烧录 |
| **Bootloader** | 串口（USART） | 2（TX/RX） | 不支持      | 需BOOT0=1启动 | 量产烧录、无调试器场景 |


### **五、PPT关键知识点回顾**
1. **下载电路硬件**：JTAG/SWD需占用GPIO，Bootloader依赖USART1和启动引脚（BOOT0/BOOT1）。  
2. **存储区关联**：Bootloader位于系统存储区（0x1FFF0000~0x1FFFF000，PPT 3.1.1节），用户程序通常存储于用户Flash区（0x08000000开始）。  
3. **低功耗影响**：下载模式不直接涉及低功耗配置，但调试器可能影响芯片功耗测试（需注意断开调试接口）。

通过合理选择下载模式，可在开发效率、硬件成本和量产需求之间取得平衡。开发阶段优先使用JTAG/SWD，量产阶段推荐Bootloader串口下载。