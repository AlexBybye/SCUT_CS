### **一、电源电路**
#### **1. 电源类型与作用**
STM32F103系列微控制器的电源系统包含三类电源，需分别设计以确保稳定运行：
- **主电源（VDD/VSS）**  
  - **电压范围**：2.0~3.6V，常规设计采用**3.3V**。  
  - **作用**：为芯片核心、数字外设（如GPIO、定时器、USART等）供电。  
  - **电路示例**：  
    - 采用 **LM1117-33稳压器**（PPT图3.2.1），输入4.5~18V宽电压，输出3.3V稳定电源。  
    - 滤波电容：  
      - **C10/C11（10μF）**：储能滤波，抑制电源纹波。  
      - **C12（0.1μF）**：高频去耦，靠近芯片电源引脚放置。  
- **备用电源（VBAT）**  
  - **作用**：当主电源VDD掉电时，为**备份域寄存器**（如RTC实时时钟、备份SRAM）供电，维持数据不丢失。  
  - **连接方式**：通过二极管或电源切换电路与VDD隔离，确保主电源优先供电。  
- **模拟电源（VDDA/AGND）**  
  - **作用**：为模拟外设（如ADC、DAC）供电，与数字电源（VDD/DGND）隔离，减少数字噪声干扰。  
  - **设计要点**：VDDA与VDD需共地（AGND与DGND短接），但走线需独立，避免耦合。

#### **2. 电源电路核心元件**
| 元件       | 功能描述                                                                 |
|------------|--------------------------------------------------------------------------|
| LM1117-33  | 低压差线性稳压器，将输入电压转换为3.3V，最大输出电流800mA。             |
| 电解电容   | 大容量储能，滤除低频纹波（如C10/C11）。                                  |
| 陶瓷电容   | 高频去耦，滤除电源高频噪声（如C12），需靠近芯片引脚放置。                |


### **二、复位电路（Reset）**
#### **1. 复位类型与触发条件**
STM32支持三种复位模式，确保芯片从已知状态启动：
- **1. 系统复位**  
  - **触发条件**：  
    - NRST引脚输入低电平（如外部按钮复位，需维持≥200ms在3.3V下）。  
    - 窗口看门狗（WWDG）或独立看门狗（IWDG）超时。  
    - 软件复位（设置寄存器位触发）。  
    - 低功耗模式下的复位（如待机模式唤醒）。  
  - **复位范围**：除备份域寄存器外的所有寄存器和外设。  
- **2. 电源复位**  
  - **触发条件**：  
    - 上电（VDD从0升至有效电压）或掉电（VDD降至阈值以下）。  
    - 手动触发（如通过复位按钮强制断电再上电）。  
  - **复位范围**：所有寄存器（含备份域寄存器需额外配置）。  
- **3. 备份域复位**  
  - **触发条件**：  
    - 软件设置备份域控制寄存器（RCC_BDCR）的BDRST位。  
    - VDD和VBAT同时掉电后，其中之一重新上电。  
  - **复位范围**：仅复位备份域寄存器（如RTC、备份SRAM）。

#### **2. 典型复位电路**
- **硬件复位电路**：  
  - **元件**：复位按钮（S2）、电容（C11，10μF）、电阻（R，10kΩ）。  
  - **原理**：  
    - 按下按钮时，C11通过按钮接地放电，NRST引脚拉低，触发复位。  
    - 松开按钮后，C11通过R充电，NRST逐渐恢复高电平，复位结束。  
  - **参数要点**：电容容量决定复位脉冲宽度，需确保VDD稳定后再释放复位信号。


### **三、时钟电路及时钟源种类**
#### **1. 时钟源分类**
STM32的时钟系统由**外部时钟源**和**内部时钟源**组成，为不同模块提供精准时序：
- **外部时钟源**  
  - **高速外部时钟（HSE）**：  
    - **类型**：4~16MHz晶振或陶瓷谐振器（PPT图3.2.3）。  
    - **作用**：为系统提供高精度主时钟，可通过锁相环（PLL）倍频至最高72MHz。  
  - **低速外部时钟（LSE）**：  
    - **频率**：32.768kHz晶振（典型RTC时钟源）。  
    - **作用**：为实时时钟（RTC）和独立看门狗（IWDG）提供低功耗时钟。  
- **内部时钟源**  
  - **高速内部时钟（HSI）**：  
    - **频率**：16MHz RC振荡器（精度±1%，温度漂移较大）。  
    - **作用**：无需外部元件，用于临时时钟或备份时钟（如HSE故障时自动切换）。  
  - **低速内部时钟（LSI）**：  
    - **频率**：40kHz RC振荡器（精度较低）。  
    - **作用**：为独立看门狗（IWDG）和RTC提供低成本时钟源（可替代LSE）。  
  - **锁相环（PLL）**：  
    - **功能**：将HSE或HSI时钟倍频（如HSE=8MHz时，PLL×9=72MHz），生成系统时钟（SYSCLK）。  
    - **应用场景**：USB模块需PLL输出48MHz或72MHz时钟（PPT图3.2.4）。

#### **2. 时钟管理与分配**
- **系统时钟（SYSCLK）**：  
  - **来源**：可选择HSE、HSI或PLL输出，最高72MHz。  
  - **分配路径**：  
    - **AHB总线**：通过AHB分频器生成HCLK（系统主频，如72MHz），驱动内核、内存和DMA。  
    - **APB1总线**：由AHB分频（如/2）生成PCLK1（最高36MHz），驱动低速外设（如USART2/3、I2C1/2）。  
    - **APB2总线**：直接使用HCLK（72MHz），驱动高速外设（如GPIO、ADC、SPI1）。  
- **特殊功能时钟**：  
  - **RTC时钟**：可选择LSE、LSI或HSE/128，用于实时计时。  
  - **USB时钟**：必须由PLL提供48MHz时钟（PPT图3.2.4中USB Prescaler配置）。  
  - **MCO引脚（PA8）**：可输出HSE、HSI、PLL或系统时钟，用于调试或同步外部设备。


### **四、最小系统电路总结**
| 电路模块   | 核心元件/配置                                                                 | 作用                                                                 |
|------------|-----------------------------------------------------------------------------|----------------------------------------------------------------------|
| 电源电路   | LM1117-33、滤波电容、VBAT备用电源                                           | 提供稳定3.3V电压，隔离模拟/数字电源，维持掉电数据。                 |
| 复位电路   | 复位按钮、RC充放电电路                                                      | 确保芯片初始化，清除异常状态。                                       |
| 时钟电路   | HSE晶振（8MHz）、LSE晶振（32.768kHz）、PLL倍频                              | 为系统和外设提供时序基准，支持高速处理和低功耗计时。                 |

**设计要点**：  
- 电源滤波电容需靠近芯片引脚，减少噪声干扰。  
- 复位电路的RC参数需根据电源电压调整，确保复位脉冲宽度足够。  
- 时钟晶振需匹配负载电容（如20PF），并远离高频元件以避免干扰。  

通过合理设计这三大电路，可搭建稳定可靠的STM32最小化系统，满足嵌入式开发的基本需求。