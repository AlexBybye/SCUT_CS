### **一、睡眠模式（Sleep Mode）**
#### **1. 进入方式**
- 通过 **WFI（Wait For Interrupt，等待中断）** 或 **WFE（Wait For Event，等待事件）** 指令触发。

#### **2. 核心特点**
- **时钟控制**：  
  - **CPU时钟关闭**，但 **外设时钟（如GPIO、USART、ADC等）和系统时钟（SYSCLK）保持运行**。  
  - 内核停止执行指令，但外设可继续工作并触发中断。  
- **电源状态**：  
  - **电压调节器保持开启**（VDD区域正常供电），功耗较高于其他低功耗模式，但仍低于正常运行模式。  
- **唤醒方式**：  
  - 任意 **中断事件**（如GPIO中断、定时器中断）或 **唤醒事件**（WFE对应的事件）。  
- **典型功耗**：约 **1-10 mA**（具体取决于外设工作状态）。  
- **应用场景**：  
  - 需要 CPU 暂停但外设持续运行的场景（如传感器数据采集期间的CPU节能）。  
  - 快速唤醒需求（唤醒时间仅需数微秒）。


### **二、停止模式（Stop Mode）**
#### **1. 进入方式**
- 需同时配置：  
  - **PWR_CR寄存器的PDDS位**（选择低功耗调节器模式）和 **LPDS位**（若使用低功耗调节器）。  
  - **Cortex-M3的SLEEPDEEP位**（使能深睡眠模式）。  
  - 执行 **WFI/WFE指令**。

#### **2. 核心特点**
- **时钟控制**：  
  - **所有1.8V区域时钟关闭**（包括HSI、HSE振荡器及PLL），仅 **备份域时钟（LSE/LSI）可选是否运行**。  
  - 外设停止工作，但 **寄存器和SRAM内容保持不变**。  
- **电源状态**：  
  - **电压调节器可配置为正常模式或低功耗模式**（通过LPDS位），进一步降低功耗。  
  - VDD电源保持供电，但电流消耗显著降低。  
- **唤醒方式**：  
  - 任一 **外部中断（EXTI）**（需在外部中断寄存器中使能）。  
  - 唤醒事件（如RTC闹钟、USB唤醒等）。  
- **典型功耗**：约 **10-100 μA**（取决于电压调节器模式和备份域配置）。  
- **应用场景**：  
  - 需深度节能但保留运行状态的场景（如电池供电设备的空闲状态）。  
  - 无需立即唤醒，但要求快速恢复现场（唤醒时间约数十微秒）。


### **三、待机模式（Standby Mode）**
#### **1. 进入方式**
- 需同时配置：  
  - **PWR_CR寄存器的PDDS位**（关闭电压调节器）。  
  - **Cortex-M3的SLEEPDEEP位**。  
  - 执行 **WFI/WFE指令**。

#### **2. 核心特点**
- **时钟控制**：  
  - **所有1.8V区域时钟完全关闭**（包括内核、外设、SRAM和寄存器）。  
  - 仅 **备份域（RTC、备份SRAM）由VBAT供电**，其他电路断电。  
- **电源状态**：  
  - **电压调节器关闭**，VDD区域功耗降至最低。  
  - 仅备份域维持供电，可通过VBAT保持RTC计时和关键数据。  
- **唤醒方式**：  
  - **WKUP引脚的上升沿**（需配置为唤醒源）。  
  - **RTC闹钟事件**、**NRST引脚复位**或 **独立看门狗（IWDG）复位**。  
- **典型功耗**：约 **0.5-5 μA**（依赖备份域是否工作）。  
- **应用场景**：  
  - 极致低功耗场景（如电池更换前的数据保持、长期待机设备）。  
  - 唤醒后需重新初始化整个系统（因SRAM和寄存器数据丢失）。


### **四、三种模式对比表格**
| **特性**         | **睡眠模式** | **停止模式**        | **待机模式**        |
| -------------- | -------- | --------------- | --------------- |
| **CPU状态**      | 停止       | 停止              | 停止              |
| **1.8V区域时钟**   | 外设时钟运行   | 关闭              | 关闭              |
| **电压调节器**      | 开启       | 正常/低功耗模式        | 关闭              |
| **SRAM/寄存器数据** | 保持       | 保持              | 丢失（除备份域）        |
| **唤醒源**        | 任意中断/事件  | 外部中断/事件         | WKUP/RTC/复位等    |



### **五、关键设计要点**
1. **功耗与功能平衡**：  
   - 若需保留外设运行，选择睡眠模式；若需深度节能但维持数据，选停止模式；若需最低功耗且可接受系统重启，选待机模式。  
2. **备份域配置**：  
   - 待机模式下，需通过VBAT为RTC和备份SRAM供电，确保掉电后时间和关键数据不丢失（PPT图3.2.1电源电路中的VBAT接口）。  
3. **唤醒后的初始化**：  
   - 待机模式唤醒后，芯片需重新初始化所有外设和寄存器，而停止模式可快速恢复现场。  

通过合理选择低功耗模式，STM32可在不同应用场景下实现能效优化，尤其适用于物联网（IoT）、可穿戴设备、便携式仪器等对功耗敏感的领域。